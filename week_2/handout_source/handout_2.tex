\documentclass[a4paper]{article}
\usepackage{titling}
\usepackage{authblk}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{rsc}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}
\DeclareSIUnit\Fahrenheit{\degree F}

\title{Lecture 2: Pythonic logic and loops}
\author[1]{Dr Benjamin J. Morgan}
\author[1,2]{Dr Andrew R. McCluskey}
\affil[1]{Department of Chemistry, University of Bath, email: b.j.morgan@bath.ac.uk}
\affil[2]{Diamond Light Source, email: andrew.mccluskey@diamond.ac.uk}
\setcounter{Maxaffil}{0}
\renewcommand\Affilfont{\itshape\small}

\pagestyle{fancy}
\fancyhf{}
\rhead{CH40208}
\lhead{\thetitle}
\rfoot{\thepage}

\begin{document}
\maketitle

\section*{Aim}
In this lecture, you will learn about logical operations, conditional statements, and for and while loops.

\section{Logical operators}

Previously, we observed how to use Python or a Jupyter Notebook as a simple calculator. 
However, programs become more useful when we are able to make the program more ``intelligent'' allowing it to perform different calculations under different circumstances.
This ability relies heavily on the use of logical operators, as we shall see. 
A logical operator is code that returns a Boolean, either \texttt{True} or \texttt{False}. 
The logical operator \texttt{==} is one of the most common, and translates to \emph{is equal to}, this operator will return \texttt{True} if the values on either side are the same, for example,
\begin{lstlisting}
# The truth

print(14.0/2.0 == 7.0)
print(13.0/2.0 == 7.0)
\end{lstlisting}
This code will return \texttt{True} then \texttt{False}. 

The equals operator is only one of many logical operators that is available in Python, some are given in Table~\ref{tab:ops}.
Each of these may be used in the same syntax as the equals operator.
\begin{table}[h]
	\centering
	\caption{Some logical operators available in Python.}
	\label{tab:ops}
	\begin{tabular}{c c c}
		\hline
		Name & Mathematical Symbol & Operator \\
		\hline
		Equals & $=$ &\texttt{==} \\
		Less than & $<$ & \texttt{<} \\
		Less than or equal & $\leq$ & \texttt{<=} \\
		Greater than & $>$ & \texttt{>} \\
		Greater than or equal to & $\geq$ & \texttt{>=} \\
		Not equal & $\neq$ & \texttt{!=}  \\
		\hline
	\end{tabular}
\end{table}
\vspace{\baselineskip}
\begin{center}
	\noindent\fbox{%
		\begin{minipage}{0.9\textwidth}%
			\vspace{0.15\baselineskip}
			\subsubsection*{Exercise}
			\begin{itemize}
				\item{Write code that will return the result of the following logical operations:}
				\begin{enumerate}
					\item{$1 = 4$}
					\item{$10 < 15$}
					\item{$3.1415 \neq 3$}
				\end{enumerate}
			\end{itemize}
		\end{minipage}
	}
\end{center}

\section{Flow control}

The \texttt{if} statement is one of the simplest, and most powerful, opeartions that Python can perform. 
This allows the code to apply different operations \emph{if} certain criteria are \texttt{True}.
An example of a Pythonic \emph{if statement} is shown below, 
\begin{lstlisting}
# The if operator

if prior_meetings == 0:
    print("Hello World!")
\end{lstlisting}
Note that in Python the indentation is incredibly important (it is how the interpreter determines what is and is not part of the \emph{if statement}.
The above code asks the question, does the variable \texttt{prior\_meetings} has the value \texttt{0}, and if it does print the string \texttt{Hello World!}

The \texttt{if} statement may be used in a more extended context, such as if the \emph{logical argument} in the if statement is not True, an \texttt{else} can be included (or even an \texttt{elif}), as shown below,
\begin{lstlisting}
# Five greetings to an old friend

if prior_meetings == 0:
    print("Hello World!")
elif prior_meetings == 1:
    print("Oh! You again")
elif prior_meetings == 2:
    print("Oh! You again")
elif prior_meetings == 3:
    print("Oh! You again")
elif prior_meetings == 4:
    print("Oh! You again")
elif prior_meetings == 5:
    print("Oh! You again")
elif prior_meetings > 5:
	print("Hello old friend!")
else:
	print("Meetings should be a positive number or zero")
\end{lstlisting}

\section{AND and OR operators}

In addition to the logical operators introduced above there are some others that it is important, and useful to be aware of. 
These are the \texttt{and} and \texttt{or} operators, which have important \emph{but different} actions:
\begin{itemize}
	\item{The \texttt{and} operation returns \texttt{True} if both operations are true.}
	\item{The \texttt{or} operation returns \texttt{True} if either operations are true.}
\end{itemize}
The code below gives and example of the syntax for these operations, 
\begin{lstlisting}
# Using and and or

if 4 > 3 and 3 > 2:
	print("This is true")
elif 4 > 3 or 3 > 3:
	print("This is also true")
else:
	print("Nothing is true")
\end{lstlisting}
\vspace{\baselineskip}
\begin{center}
	\noindent\fbox{%
		\begin{minipage}{0.9\textwidth}%
			\vspace{0.15\baselineskip}
			\subsubsection*{Exercise}
			\begin{itemize}
				\item{Use the \texttt{or} operator to reduce the \texttt{prior\_meetings} code above to just 8 lines long. \textbf{Hint}: think about other operators from Table~\ref{tab:ops} to reduce the length of the code.}
			\end{itemize}
		\end{minipage}
	}
\end{center}

\section{Loops}

One of the best uses of programming (and computers) is to perform repetitive task over and over. 
For this we use \emph{loops}, within Python there are two common types of loop:
\begin{itemize}
	\item{\texttt{for} loops iterate over a given sequence.}
	\item{\texttt{while} loops repeat as long as a certain logical operation is \texttt{True}.}
\end{itemize}
An example of each of a \texttt{for} and \texttt{while} loop is shown below, both perform the same function, 
\begin{lstlisting}
# For loop

for i in range(5):
	print(i)

i = 0
while i < 5:
	print(i)
	i = i + 1
\end{lstlisting}
Both of these code blocks will print the numbers $0$ to $4$, however the \texttt{for} loop is clearly more concise. 
Additionally, the \texttt{while} loop is more prone to accidently running an \emph{infinite}. 
If you were to forget to manually iterate the variable \texttt{i} (this is the line \texttt{i = i + 1}), then the \texttt{while} condition would always be \texttt{True} and therefore the code would run forever within this loop. 
For this reason it is suggested that, where possible, you use a \texttt{for} loop over a \texttt{while} loop.

The \texttt{for} loop will iterate the variable (in the example above this variable is named \texttt{i}) through whatever sequence is given (this is \texttt{range(5)} above, which is equivalent to the \emph{list} \texttt{[0, 1, 2, 3, 4]}). 
The sequence does not necessarily have to be a \texttt{range} command, it may be any \texttt{list} or \texttt{numpy.ndarray} (we will discuss these types later in the course). 
For example, in the code below we iterate though the first ten chemical element symbols, 
\begin{lstlisting}
# Printing the periodic table

elements = ["H", "He", "Li", "Be", "B", "C", "N", "O", "F", "Ne"]

for symbol in elements:
	print(symbol)

for i, symbol in enumerate(elements):
	print("The index of the list for {} is {}.".format(symbol, i)).
\end{lstlisting}
It is possible to use the \texttt{enumerate} command to count through the list during the loop, as shown in the second example above. 
\vspace{\baselineskip}
\begin{center}
	\noindent\fbox{%
		\begin{minipage}{0.9\textwidth}%
			\vspace{0.15\baselineskip}
			\subsubsection*{Exercise}
			\begin{itemize}
				\item{Recall from first and second year, that Python counts indices in a list from 0. How could the above code be adapted such that the correct atomic number will be printed?}
			\end{itemize}
		\end{minipage}
	}
\end{center}

\subsection{Escaping loops}

Sometimes it is computationally efficient to leave a \texttt{for} loop, to skip a particular value, under a certain condition. 
For this, the commands \texttt{break} and \texttt{continue} are available. 
The \texttt{break} command will exit the \emph{inner-most} loop that is being carried out, while the \texttt{continue} command will skip the current value and jump immediately to the next. 
Examples of how these may be used are shown below, where the \texttt{len} function will return the \emph{length} of the list, 
\begin{lstlisting}
# Finding the zero in a list

numbers = [1, 5, 7, 0, 2, 6, 2]
for i in range(len(numbers)):
	if numbers[i] == 0:
		break

print("The zero is at index {}.".format(i))

# Making all the negative values positive

numbers = [-2, 4, 1, -5, 2, 6, -3, -4]
for i in range(len(numbers)):
	if numbers[i] >= 0:
		continue
	else:
		numbers[i] = numbers[i] * -1
\end{lstlisting}
Note that the above examples are toy problems and there are more efficient way to carry-out these specific operations in Python.

\section{Problems}

The week there are two exercises to be carried out.

\subsection{Interatomic distances}

Write code that will take the \emph{x}, \emph{y}, and \emph{z} coordinates of three atoms, and calculate the distances $r$ between each pair, then print the distances along with the atoms that the distances are between. 
The equation for $r$ between two atoms is, 
\begin{equation}
	r = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2}. 
\end{equation}
This expression is widely used in atomistic simulations.
\textbf{Remember}: Plan the procedure for your code before you start to write any Python. 
Use your code to calculate the distances between the atoms in the following molecules:
\begin{enumerate}
	\item{Atom 1: ($0.1$, $0.5$, $3.2$); Atom 2: ($0.4$, $0.5$, $2.3$); Atom 3: ($-0.3$, $0.3$, $1.7$)}
	\item{Atom 1: ($-0.1$, $0.5$, $1.5$); Atom 2: ($0.2$, $0.5$, $2.6$); Atom 3: ($0.5$, $0.5$, $3.7$)}
\end{enumerate}
Comment on the shape of each of the molecules. 

\subsection{Equilibrium constants}

Write code that will calculate values of the equilibrium constant, $K$, for a given free-energy change over a range of temperatures. 
The program should ask the user for a free-energy value, $\Delta G$ or $\	Delta g$, and to specify the units for this (either \si{\kilo\joule\per\mol}, \si{\eV}, or \si{\joule}). 
The initial temperature, $T_{\text{init}}$, final temperature, $T_{\text{final}}$, and temperature step size, $T_{\text{step}}$ should also be entered by the user (in \si{\kelvin}). 
In order to learn more about how to do this with the \texttt{range} function, check the documentation online (\url{https://www.w3schools.com/python/ref_func_range.asp}).
The equilibrium constant equation is, 
\begin{equation} 
	K = \exp{\bigg(\frac{-\Delta G}{RT}\bigg)} = \exp{\bigg(\frac{-\Delta g}{k_BT}\bigg)}
\end{equation}
where, $R = \SI{8.314}{\joule\per\kelvin\per\mol}$, $k_B = \SI{1.3806e-23}{\joule}$, and $\SI{1}{\eV} = \SI{96.485}{\kilo\joule\per\mol}$. 

When you check for what is typed, donâ€™t forget to check for upper-case as well as lower-case letters, as these characters have different ascii codes.
You should also anticipate the possibility of the user entering a completely different letter (by mistake): what action would be appropriate in this event?
Additionally, make sure that the user cannot make the temperature \emph{unphysical} (e.g. less than or equal to zero). 
Again, remember to plan before you code. 

Test the code using a temperature range from \SIrange{100}{2000}{\kelvin} with a step size of \SI{100}{\kelvin}, and with free energies of:
\begin{enumerate}
	\item{\SI{-12.177}{\kilo\joule\per\mol}}
	\item{\SI{-0.1452}{\eV}}
	\item{\SI{-2.6308e-20}{\joule}}
\end{enumerate}
Comment on the values at \SI{300}{\kelvin}. 

%\bibliographystyle{rsc}
%\bibliography{handout_2}

\end{document}